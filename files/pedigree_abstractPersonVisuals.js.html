<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>pedigree&#x2F;abstractPersonVisuals.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/AbstractHoverbox.html">AbstractHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/AbstractNode.html">AbstractNode</a></li>
            
                <li><a href="..&#x2F;classes/AbstractNodeVisuals.html">AbstractNodeVisuals</a></li>
            
                <li><a href="..&#x2F;classes/AbstractPerson.html">AbstractPerson</a></li>
            
                <li><a href="..&#x2F;classes/AbstractPersonVisuals.html">AbstractPersonVisuals</a></li>
            
                <li><a href="..&#x2F;classes/ActionStack.html">ActionStack</a></li>
            
                <li><a href="..&#x2F;classes/Graph.html">Graph</a></li>
            
                <li><a href="..&#x2F;classes/GroupHoverbox.html">GroupHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/Legend.html">Legend</a></li>
            
                <li><a href="..&#x2F;classes/NodeMenu.html">NodeMenu</a></li>
            
                <li><a href="..&#x2F;classes/NodetypeSelectionBubble.html">NodetypeSelectionBubble</a></li>
            
                <li><a href="..&#x2F;classes/Partnership.html">Partnership</a></li>
            
                <li><a href="..&#x2F;classes/PartnershipHoverbox.html">PartnershipHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/PartnershipVisuals.html">PartnershipVisuals</a></li>
            
                <li><a href="..&#x2F;classes/PedigreeEditor.html">PedigreeEditor</a></li>
            
                <li><a href="..&#x2F;classes/Person.html">Person</a></li>
            
                <li><a href="..&#x2F;classes/PersonGroup.html">PersonGroup</a></li>
            
                <li><a href="..&#x2F;classes/PersonGroupVisuals.html">PersonGroupVisuals</a></li>
            
                <li><a href="..&#x2F;classes/PersonHoverbox.html">PersonHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/PersonVisuals.html">PersonVisuals</a></li>
            
                <li><a href="..&#x2F;classes/PlaceHolder.html">PlaceHolder</a></li>
            
                <li><a href="..&#x2F;classes/PlaceHolderVisuals.html">PlaceHolderVisuals</a></li>
            
                <li><a href="..&#x2F;classes/Pregnancy.html">Pregnancy</a></li>
            
                <li><a href="..&#x2F;classes/PregnancyVisuals.html">PregnancyVisuals</a></li>
            
                <li><a href="..&#x2F;classes/SaveLoadEngine.html">SaveLoadEngine</a></li>
            
                <li><a href="..&#x2F;classes/SaveLoadIndicator.html">SaveLoadIndicator</a></li>
            
                <li><a href="..&#x2F;classes/TemplateSelector.html">TemplateSelector</a></li>
            
                <li><a href="..&#x2F;classes/Workspace.html">Workspace</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: pedigree&#x2F;abstractPersonVisuals.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 * An abstract superclass for the a graphic engine used by nodes on the Pedigree graph. Can display
 * a shape representing the gender of the attached node.
 *
 * @class AbstractPersonVisuals
 * @extends AbstractNodeVisuals
 * @constructor
 * @param {AbstractPerson} node The node for which this graphics are handled
 * @param {Number} x The x coordinate on the canvas
 * @param {Number} y the y coordinate on the canvas
 *&#x2F;

var AbstractPersonVisuals = Class.create(AbstractNodeVisuals, {

    initialize: function($super, node, x, y) {
        this._icon = null;
        this._radius = PedigreeEditor.attributes.radius;
        $super(node, x, y);
        this._width = PedigreeEditor.attributes.radius * 4;
        this._adoptedShape = null;
        this.setIcon();
        this._highlightBox = editor.getPaper().rect(this.getX()-(this._width&#x2F;2), this.getY()-(this._width&#x2F;2),
            this._width, this._width, 5).attr(PedigreeEditor.attributes.boxOnHover);
        this._highlightBox.attr({fill: &#x27;black&#x27;, opacity: 0, &#x27;fill-opacity&#x27;: 0});
        this._highlightBox.insertBefore(this.getIcon().flatten());
        this._idLabel = editor.getPaper().text(x, y,  editor.DEBUG_MODE ? node.getID() : &quot;&quot;).attr(PedigreeEditor.attributes.dragMeLabel).insertAfter(this._icon.flatten());
    },

    &#x2F;**
     * Returns the Raphael element representing the gender of the node.
     *
     * @method getIcon
     * @return {Raphael.st | Raphael.el} Raphael element
     *&#x2F;
    getIcon: function() {
        return this._icon;
    },

    &#x2F;**
     * Updates the icon representing the gender of the node
     *
     * @method setIcon
     * @param [$super]
     *&#x2F;
    setIcon: function($super) {
        this.setGenderSymbol();
    },

    &#x2F;**
     * Changes the position of the node to (X,Y)
     *
     * @method setPos
     * @param {Number} x The x coordinate
     * @param {Number} y The y coordinate
     * @param {Boolean} animate Set to true if you want to animate the transition
     * @param {Function} callback The function called at the end of the animation
     *&#x2F;
    setPos: function(x, y, animate, callback) {
        var me = this;
        this.getNode().getPartnerships().each(function(partnership) {
            partnership.getGraphics().updatePartnerConnection(me.getNode(), x, y, partnership.getX(), partnership.getY(), animate);
        });
        var p = this.getNode().getParentPregnancy();
        p &amp;&amp; p.getGraphics().updateChildConnection(this.getNode(), x, y, p.getX(), p.getY(), animate);

        if(animate &amp;&amp; (this.getX() != x || this.getY() != y)) {
            this.getAllGraphics().stop().animate({&#x27;transform&#x27;: &quot;t &quot; + (x-this.getX()) + &quot;,&quot; +(y-this.getY()) + &quot;...&quot;},
                1000, &quot;easeInOut&quot;, function() { me._updatePositionData(x, y);callback &amp;&amp; callback();});
        }
        else {
            this.getAllGraphics().transform(&quot;t &quot; + (x-this.getX()) + &quot;,&quot; +(y-this.getY()) + &quot;...&quot;);
            me._updatePositionData(x, y);
        }
    },

    &#x2F;**
     * Saves the x and y values as current coordinates and updates connections with the new position
     *
     * @method _updatePositionData
     * @param {Number} x The new x coordinate
     * @param {Number} y The new y coordinate
     * @private
     *&#x2F;
    _updatePositionData: function(x, y) {
        var me = this;
        me._absoluteX = x;
        me._absoluteY = y;
    },

    &#x2F;**
     * Returns the distance from the center of the genderSymbol to the rightmost point of the shape.
     *
     * @method getRadius
     * @return {Number}
     *&#x2F;
    getRadius: function() {
        return this._radius;
    },

    &#x2F;**
     * Returns the box around the element that appears when the node is highlighted
     *
     * @method getHighlightBox
     * @return {Raphael.rect} Raphael rectangle element
     *&#x2F;
    getHighlightBox: function() {
        return this._highlightBox;
    },

    &#x2F;**
     * Displays the highlightBox around the node
     *
     * @method highlight
     *&#x2F;
    highlight: function() {
        this.getHighlightBox().attr({&quot;opacity&quot;: .5, &#x27;fill-opacity&#x27;:.5});
    },

    &#x2F;**
     * Draws brackets around the node icon to show that this node is adopted
     *
     * @method drawAdoptedShape
     *&#x2F;
    drawAdoptedShape: function() {
        this._adoptedShape &amp;&amp; this._adoptedShape.remove();
        var r = PedigreeEditor.attributes.radius,
            x1 = this.getX() - ((0.8) * r),
            x2 = this.getX() + ((0.8) * r),
            y = this.getY() - ((1.3) * r),
            brackets = &quot;M&quot; + x1 + &quot; &quot; + y + &quot;l&quot; + r&#x2F;(-2) +
                &quot; &quot; + 0 + &quot;l0 &quot; + (2.6 * r) + &quot;l&quot; + (r)&#x2F;2 + &quot; 0M&quot; + x2 +
                &quot; &quot; + y + &quot;l&quot; + (r)&#x2F;2 + &quot; 0&quot; + &quot;l0 &quot; + (2.6 * r) + &quot;l&quot; +
                (r)&#x2F;(-2) + &quot; 0&quot;;
        this._adoptedShape = editor.getPaper().path(brackets).attr(&quot;stroke-width&quot;, 3);
        this._adoptedShape.insertBefore(this.getGenderShape().flatten());
    },

    &#x2F;**
     * Removes the brackets around the node icon that show that this node is adopted
     *
     * @method removeAdoptedShape
     *&#x2F;
    removeAdoptedShape: function() {
        this._adoptedShape &amp;&amp; this._adoptedShape.remove();
    },

    &#x2F;**
     * Returns the raphael element or set containing the adoption shape
     *
     * @method getAdoptedShape
     * @return {Raphael.el} Raphael Element
     *&#x2F;
    getAdoptedShape: function() {
        return this._adoptedShape;
    },

    &#x2F;**
     * Hides the highlightBox around the node
     *
     * @method unHighlight
     *&#x2F;
    unHighlight: function() {
        this.getHighlightBox().attr({&quot;opacity&quot;: 0, &#x27;fill-opacity&#x27;:0});
    },

    &#x2F;**
     * Returns a Raphael set or element that contains the graphics associated with this node, excluding the labels.
     *
     * @method getShapes
     *&#x2F;
    getShapes: function($super) {
        var shapes = $super().push(this.getIcon());
        this.getAdoptedShape() &amp;&amp; shapes.push(this.getAdoptedShape());
        return shapes;
    },

    &#x2F;**
     * Returns a Raphael set that contains all the graphics and labels associated with this node.
     *
     * @method getAllGraphics
     * @return {Raphael.st}
     *&#x2F;
    getAllGraphics: function($super) {
        return editor.getPaper().set(this.getHighlightBox(), this._idLabel).concat($super());
    },

    &#x2F;**
     * Returns the Raphael element representing the gender of the node.
     *
     * @method getGenderSymbol
     * @return {Raphael.st|Raphael.el} Raphael set or Raphael element
     *&#x2F;
    getGenderSymbol: function() {
        return this._genderSymbol;
    },

    &#x2F;**
     * Returns only the shape element from the genderSymbol
     *
     * @method getGenderShape
     * @return {Raphael.st|Raphael.el}
     *&#x2F;
    getGenderShape: function() {
        return this._genderShape;
    },

    &#x2F;**
     * Sets&#x2F;replaces the gender symbol with the symbol appropriate for the gender.s
     *
     * @method setGenderSymbol
     *&#x2F;
    setGenderSymbol: function() {
        this._genderSymbol &amp;&amp; this._genderSymbol.remove();
        var shape,
            x = this.getX(),
            y = this.getY(),
            radius = this._radius = (this.getNode().getGender() == &#x27;U&#x27;) ? PedigreeEditor.attributes.radius * (Math.sqrt(3)&#x2F;2) : PedigreeEditor.attributes.radius;

        if (this.getNode().getGender() == &#x27;F&#x27;) {
            shape = editor.getPaper().circle(x, y, PedigreeEditor.attributes.radius);
        }
        else {
            shape = editor.getPaper().rect(x - radius, y - radius, radius * 2, radius * 2);
        }
        shape.attr(PedigreeEditor.attributes.nodeShape);
        shape = (this.getNode().getGender() == &#x27;U&#x27;) ? shape.transform(&quot;...r45&quot;) : shape;
        this._genderShape = shape;

        &#x2F;&#x2F;var shadow = shape.glow({width: 5, fill: true, opacity: 0.1}).translate(3,3);
        var shadow = shape.clone().attr({stroke: &#x27;none&#x27;, fill: &#x27;gray&#x27;, opacity: .3});
        shadow.translate(3,3);
        shadow.insertBefore(shape);
        this.getGenderSymbol() &amp;&amp; this.getGenderSymbol().remove();
        this._genderSymbol = editor.getPaper().set(shadow, shape);

        var p = this.getNode().getParentPregnancy();
        p &amp;&amp; p.getGraphics().updateChildConnection(this.getNode(), this.getX(), this.getY(), p.getX(), p.getY());

        var me = this;
        this.getNode().getPartnerships().each(function(partnership) {
            partnership.getGraphics().updatePartnerConnection(me.getNode(), me.getX(), me.getY(), partnership.getX(), partnership.getY());
        });
        this._icon = this._genderSymbol;
    }
});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
