<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>pedigree&#x2F;actionStack.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/AbstractHoverbox.html">AbstractHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/AbstractNode.html">AbstractNode</a></li>
            
                <li><a href="..&#x2F;classes/AbstractNodeVisuals.html">AbstractNodeVisuals</a></li>
            
                <li><a href="..&#x2F;classes/AbstractPerson.html">AbstractPerson</a></li>
            
                <li><a href="..&#x2F;classes/AbstractPersonVisuals.html">AbstractPersonVisuals</a></li>
            
                <li><a href="..&#x2F;classes/ActionStack.html">ActionStack</a></li>
            
                <li><a href="..&#x2F;classes/Graph.html">Graph</a></li>
            
                <li><a href="..&#x2F;classes/GroupHoverbox.html">GroupHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/Legend.html">Legend</a></li>
            
                <li><a href="..&#x2F;classes/NodeMenu.html">NodeMenu</a></li>
            
                <li><a href="..&#x2F;classes/NodetypeSelectionBubble.html">NodetypeSelectionBubble</a></li>
            
                <li><a href="..&#x2F;classes/Partnership.html">Partnership</a></li>
            
                <li><a href="..&#x2F;classes/PartnershipHoverbox.html">PartnershipHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/PartnershipVisuals.html">PartnershipVisuals</a></li>
            
                <li><a href="..&#x2F;classes/PedigreeEditor.html">PedigreeEditor</a></li>
            
                <li><a href="..&#x2F;classes/Person.html">Person</a></li>
            
                <li><a href="..&#x2F;classes/PersonGroup.html">PersonGroup</a></li>
            
                <li><a href="..&#x2F;classes/PersonGroupVisuals.html">PersonGroupVisuals</a></li>
            
                <li><a href="..&#x2F;classes/PersonHoverbox.html">PersonHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/PersonVisuals.html">PersonVisuals</a></li>
            
                <li><a href="..&#x2F;classes/PlaceHolder.html">PlaceHolder</a></li>
            
                <li><a href="..&#x2F;classes/PlaceHolderVisuals.html">PlaceHolderVisuals</a></li>
            
                <li><a href="..&#x2F;classes/Pregnancy.html">Pregnancy</a></li>
            
                <li><a href="..&#x2F;classes/PregnancyVisuals.html">PregnancyVisuals</a></li>
            
                <li><a href="..&#x2F;classes/SaveLoadEngine.html">SaveLoadEngine</a></li>
            
                <li><a href="..&#x2F;classes/SaveLoadIndicator.html">SaveLoadIndicator</a></li>
            
                <li><a href="..&#x2F;classes/TemplateSelector.html">TemplateSelector</a></li>
            
                <li><a href="..&#x2F;classes/Workspace.html">Workspace</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: pedigree&#x2F;actionStack.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 * ActionStack is responsible for keeping track of user actions and providing an undo&#x2F;redo functionality
 *
 * @class ActionStack
 * @constructor
 *&#x2F;
var ActionStack = Class.create({
    initialize: function() {
        this._index = 0;
        this._stack = [];
        this._maxMarkerID = 1;
    },

    &#x2F;**
     * Returns the array implementation of the action stack
     *
     * @method getStack
     * @return {Array}
     *&#x2F;
    getStack: function() {
        return this._stack;
    },

    &#x2F;**
     * Replaces the current stack with newStack
     *
     * @method setStack
     * @param {Array} newStack
     *&#x2F;
    setStack: function(newStack) {
        this._stack = newStack;
    },

    &#x2F;**
     * Returns the index of the current state of the application
     *
     * @method getIndex
     * @return l{Number}
     *&#x2F;
    getIndex: function() {
        return this._index;
    },

    &#x2F;**
     * Changes the index of the current state of the application to newIndex
     *
     * @method setIndex
     * @param {Number} newIndex
     *&#x2F;
    setIndex: function(newIndex) {
        (newIndex &gt;= 0) &amp;&amp; (this._index = newIndex);
    },

    &#x2F;**
     * Moves one state forward in the action stack
     *
     * @method redo
     *&#x2F;
    redo: function() {
        document.fire(&quot;pedigree:actionEvent&quot;, {actionType: &quot;redo&quot;})
        var action = this.getStack()[this.getIndex()];
        if(action) {
            this.setIndex(this.getIndex() + 1)
            if (action.redo) {
                action.redo(action);
            }
            else if(action.markerType == &quot;start&quot;) {
                var targetID = action.id;
                while(this.getStack()[this.getIndex()] &amp;&amp; this.getStack()[this.getIndex()].markerType != &quot;end&quot;
                    &amp;&amp; this.getStack()[this.getIndex()].id != targetID) {
                    this.redo();
                }
                this.getStack()[this.getIndex()] &amp;&amp; this.setIndex(this.getIndex() + 1);
            }
        }
    },

    &#x2F;**
     * Moves one state backwards in the action stack
     *
     * @method undo
     *&#x2F;
    undo: function() {
        document.fire(&quot;pedigree:actionEvent&quot;, {actionType: &quot;undo&quot;})
        if(this.getIndex() &gt; 0) {
            this.setIndex(this.getIndex() - 1);
            var action = this.getStack()[this.getIndex()];
            if(action) {
                if (action.undo) {
                    action.undo(action);
                }
                else if(action.markerType == &quot;end&quot;) {
                    var targetID = action.id;
                    while(this.getStack()[this.getIndex()-1].markerType != &quot;start&quot;
                        &amp;&amp; this.getStack()[this.getIndex()-1].id != targetID &amp;&amp; this.getIndex() &gt; 0) {
                        this.undo();
                    }
                    this.setIndex(this.getIndex() - 1);
                }
            }
        }
    },

    &#x2F;**
     * Pushes a new state to the front of the action stack
     *
     * @method push
     * @param el Such that el.undo and el.redo are functions
     *&#x2F;
    push: function(el) {
        if(el &amp;&amp; typeof(el[&quot;undo&quot;]) == &#x27;function&#x27; &amp;&amp; typeof(el[&quot;redo&quot;]) == &#x27;function&#x27;) {
            document.fire(&quot;pedigree:actionEvent&quot;, {actionType: &quot;push&quot;})
            this.setStack(this.getStack().splice(0, this.getIndex()));
            this.setIndex(this.getIndex() + 1);
            this.getStack().push(el);
        }
    },

    &#x2F;**
     * Starts an action grouping in the stack
     *
     * @method pushStartMarker
     * @return {Number} The id of the action group
     *&#x2F;
    pushStartMarker: function() {
        this.setIndex(this.getIndex() + 1);
        var markerID = this.getMaxMarkerID() + 1;
        this.setMaxMarkerID(markerID);
        this.getStack().push({markerType: &quot;start&quot;, id: markerID});
        return markerID;
    },

    &#x2F;**
     * Closes action grouping with id markerID in the stack
     *
     * @method pushEndMarker
     * @param {Number} markerID ID of the action group
     *&#x2F;
    pushEndMarker: function(markerID) {
        this.setIndex(this.getIndex() + 1);
        this.getStack().push({markerType: &quot;end&quot;, id: markerID});
    },

    &#x2F;**
     * Returns ID of the action group with the largest ID
     *
     * @method getMaxMarkerID
     * @return {Number}
     *&#x2F;
    getMaxMarkerID: function() {
        return this._maxMarkerID;
    },

    &#x2F;**
     * Sets newID as the largest action group ID
     *
     * @method setMaxMarkerID
     *&#x2F;
    setMaxMarkerID: function(newID) {
        this._maxMarkerID = newID;
    },

    &#x2F;**
     * Pops the front element of the stack
     *
     * @method pop
     *&#x2F;
    pop: function() {
        this.setStack(this.getStack().splice(0, this.getIndex() - 1));
        this.setIndex(this.getIndex() - 1);
    },

    &#x2F;**
     * Returns the front element of the stack
     *
     * @method peek
     * @return {null|Object}
     *&#x2F;
    peek: function() {
        return this.size() == 0 ? null : this.getStack()[this.size() - 1];
    },

    &#x2F;**
     * Returns the number of elements in the stack
     *
     * @method size
     * @return {Number}
     *&#x2F;
    size: function() {
        return this.getStack().length;
    }
});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
