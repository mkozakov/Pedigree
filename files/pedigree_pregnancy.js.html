<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>pedigree&#x2F;pregnancy.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/AbstractHoverbox.html">AbstractHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/AbstractNode.html">AbstractNode</a></li>
            
                <li><a href="..&#x2F;classes/AbstractNodeVisuals.html">AbstractNodeVisuals</a></li>
            
                <li><a href="..&#x2F;classes/AbstractPerson.html">AbstractPerson</a></li>
            
                <li><a href="..&#x2F;classes/AbstractPersonVisuals.html">AbstractPersonVisuals</a></li>
            
                <li><a href="..&#x2F;classes/ActionStack.html">ActionStack</a></li>
            
                <li><a href="..&#x2F;classes/ClassName.html">ClassName</a></li>
            
                <li><a href="..&#x2F;classes/Graph.html">Graph</a></li>
            
                <li><a href="..&#x2F;classes/GroupHoverbox.html">GroupHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/Legend.html">Legend</a></li>
            
                <li><a href="..&#x2F;classes/NodeMenu.html">NodeMenu</a></li>
            
                <li><a href="..&#x2F;classes/NodetypeSelectionBubble.html">NodetypeSelectionBubble</a></li>
            
                <li><a href="..&#x2F;classes/Partnership.html">Partnership</a></li>
            
                <li><a href="..&#x2F;classes/PartnershipHoverbox.html">PartnershipHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/PartnershipVisuals.html">PartnershipVisuals</a></li>
            
                <li><a href="..&#x2F;classes/PedigreeEditor.html">PedigreeEditor</a></li>
            
                <li><a href="..&#x2F;classes/Person.html">Person</a></li>
            
                <li><a href="..&#x2F;classes/PersonGroup.html">PersonGroup</a></li>
            
                <li><a href="..&#x2F;classes/PersonGroupVisuals.html">PersonGroupVisuals</a></li>
            
                <li><a href="..&#x2F;classes/PersonHoverbox.html">PersonHoverbox</a></li>
            
                <li><a href="..&#x2F;classes/PersonVisuals.html">PersonVisuals</a></li>
            
                <li><a href="..&#x2F;classes/PlaceHolder.html">PlaceHolder</a></li>
            
                <li><a href="..&#x2F;classes/PlaceHolderVisuals.html">PlaceHolderVisuals</a></li>
            
                <li><a href="..&#x2F;classes/Pregnancy.html">Pregnancy</a></li>
            
                <li><a href="..&#x2F;classes/PregnancyVisuals.html">PregnancyVisuals</a></li>
            
                <li><a href="..&#x2F;classes/SaveLoadEngine.html">SaveLoadEngine</a></li>
            
                <li><a href="..&#x2F;classes/SaveLoadIndicator.html">SaveLoadIndicator</a></li>
            
                <li><a href="..&#x2F;classes/Workspace.html">Workspace</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: pedigree&#x2F;pregnancy.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 * Pregnancy is a node contained by a Partnership and is used to group and manage
 * monozygotic twins.
 *
 * @class Pregnancy
 * @extends AbstractNode
 * @constructor
 * @param {Number} x X coordinate at which the pregnancy node will be placed
 * @param {Number} y Y coordinate at which the pregnancy node will be placed
 * @param {Partnership} partnership The partnership that has this pregnancy
 * @param {Number} id ID of this node
 *&#x2F;

var Pregnancy = Class.create(AbstractNode, {

    initialize: function($super, x, y, partnership, id) {
        this._partnership = partnership;
        this._PersonChildren = [];
        this._PlaceHolderChildren = [];
        this._PersonGroupChildren = [];
        this._isActive = false;
        this._type = &#x27;Pregnancy&#x27;;
        $super(x, y, id);
        this._gender = &quot;U&quot;;
        partnership.addPregnancy(this);
    },

    &#x2F;**
     * Generates and returns an instance of PregnancyVisuals
     *
     * @method _generateGraphics
     * @param {Number} x X coordinate on the canvas
     * @param {Number} y X coordinate on the canvas
     * @return {PregnancyVisuals}
     * @private
     *&#x2F;
    _generateGraphics: function(x, y) {
        return new PregnancyVisuals(this, x, y);
    },

    &#x2F;**
     * Returns the gender of the twins in this pregnancy
     *
     * @method getGender
     * @return {String} &quot;M&quot;, &quot;F&quot;, or &quot;U&quot;
     *&#x2F;
    getGender: function() {
        return this._gender;
    },

    &#x2F;**
     * Changes the gender of this pregnancy
     *
     * @method setGender
     * @param {String} gender &quot;M&quot;, &quot;F&quot;, or &quot;U&quot;
     *&#x2F;
    setGender: function(gender) {
        if(this._gender != gender &amp;&amp; !this.isGenderLocked()) {
            this._gender = gender;
            this.getChildren().each(function(child) {
                if(child.getGender() != gender) {
                    child.setGender(gender);
                }
            })
        }
    },

    &#x2F;**
     * Returns true if editing the gender of this pregnancy is currently impossible
     *
     * @method isGenderLocked
     * @return {Boolean}
     *&#x2F;
    isGenderLocked: function() {
        var lockedGender = false;
        this.getChildren(&quot;Person&quot;).each(function(child) {
            if(child.getGender() != &#x27;U&#x27; &amp;&amp; child.getPartners().length != 0) {
                lockedGender = true;
                throw $break;
            }
        });
        return lockedGender;
    },

    &#x2F;**
     * Returns the partnership that has this pregnancy
     *
     * @method getPartnership
     * @return {Partnership}
     *&#x2F;
    getPartnership: function() {
        return this._partnership;
    },

    &#x2F;**
     * Returns an array of nodes that are children of this Pregnancy
     *
     * @method getChildren
     * @param {String} [type]* Filters for types of children to include (such as &quot;Person&quot;, &quot;PlaceHolder, etc)
     * @return {Array}
     *&#x2F;
    getChildren: function(type) {
        if(arguments.length == 0) {
            return this._PlaceHolderChildren.concat(this._PersonGroupChildren, this._PersonChildren);
        }
        else {
            var children = [];
            for(var i = 0; i &lt; arguments.length; i++) {
                if(this[&quot;_&quot; + arguments[i] + &quot;Children&quot;]) {
                    children = children.concat(this[&quot;_&quot; + arguments[i] + &quot;Children&quot;]);
                }
            }
            return children;
        }
    },

    &#x2F;**
     * Returns true if someNode is a child of this pregnancy.
     *
     * @method hasChild
     * @param {AbstractPerson} someNode
     * @return {Boolean}
     *&#x2F;
    hasChild: function(someNode) {
        return this.getChildren(someNode.getType()).indexOf(someNode) &gt; -1;
    },

    &#x2F;**
     * Creates a new node and sets it as a child of this pregnancy
     *
     * @method createChild
     * @param {String} type Any type of AbstractPerson
     * @return {AbstractPerson} The created child or null if creation failed
     *&#x2F;
    createChild: function(type) {
        if(this.isChildTypeValid(type) ) {
            var id = this.getID();
            var pos = editor.findPosition({below: id}, [&#x27;child&#x27;]);
            var child = editor.getGraph()[&quot;add&quot; + type](pos[&#x27;child&#x27;].x, pos[&#x27;child&#x27;].y, this.getGender());
            this.addChild(child);
            return child;
            &#x2F;&#x2F;document.fire(&quot;pedigree:child:added&quot;, {node: child, &#x27;relatedNodes&#x27; : [], &#x27;sourceNode&#x27; : this});
        }
        return null;
    },

    &#x2F;**
     * Creates a new node and sets it as a child of this pregnancy.
     * Creates action stack entry.
     *
     * @method createChildAction
     *&#x2F;
    createChildAction: function() {
        var childInfo = this.createChild(&quot;PlaceHolder&quot;).getInfo();
        var nodeID = this.getID();
        var undo = function() {
            var child = editor.getGraph().getNodeMap()[childInfo.id];
            child &amp;&amp; child.remove();
        };
        var redo = function() {
            var preg = editor.getGraph().getNodeMap()[nodeID];
            var child = editor.getGraph().addPlaceHolder(childInfo.x, childInfo.y, preg.getGender(), childInfo.id);
            preg.addChild(child);
        }
        editor.getActionStack().push({undo: undo, redo: redo});
    },

    &#x2F;**
     * Adds someNode as this pregnancy&#x27;s child
     *
     * @method addChild
     * @param someNode is an AbstractPerson
     *&#x2F;
    addChild: function(someNode) {
        if(someNode &amp;&amp; this.canBeParentOf(someNode)) {
            this.setGender(someNode.getGender());
            this[&quot;_&quot; + someNode.getType() + &quot;Children&quot;].push(someNode);
            someNode.setParentPregnancy(this);
            this.getGraphics().addChild(someNode);
            this.updateActive()
        }
    },

    &#x2F;**
     * Breaks the connection between the pregnancy and child.
     * Returns child;
     *
     * @method removeChild
     * @param {AbstractPerson} child Child of this pregnancy
     *&#x2F;
    removeChild: function(child) {
        this.getGraphics().removeChild(child);
        child.setParentPregnancy(null);
        this[&quot;_&quot; + child.getType() + &quot;Children&quot;] = this[&quot;_&quot; + child.getType() + &quot;Children&quot;].without(child);
        if(this.getChildren().length == 0) {
            this.remove(false);
        }
        else {
            this.updateActive();
        }
        var p = this.getPartnership().getPartners();
        if(this.isPlaceHolderPregnancy() &amp;&amp; (p[0].getType() == &quot;PlaceHolder&quot; || p[1].getType() == &quot;PlaceHolder&quot;)) {
            this.remove(false);
        }
    },

    &#x2F;**
     * Breaks connections with all related nodes and removes this node from
     * the record.
     *
     * @method remove
     * @param [$super]
     * @param [isRecursive=false] {Boolean} set to true to remove all nodes that will result in being unrelated to the proband
     * @param [skipConfirmation=false] {Boolean} if true, no confirmation box will pop up
     * @return {Object} in the form
     *
     {
     confirmed: true&#x2F;false,
     affected: {
     PersonNodes : [Person1, Person2, ...],
     PartnershipNodes : [Partnership1, Partnership2, ...],
     PregnancyNodes : [Pregnancy1, Pregnancy2, ...],
     PersonGroupNodes : [PersonGroup1, PersonGroup2, ...],
     PlaceHolderNodes : [PlaceHolder1, PlaceHolder2, ...]
     },
     created: [PlaceHolder1, PlaceHolder2, ...]
     }
     *&#x2F;
    remove: function($super, isRecursive, skipConfirmation) {
        editor.getGraph().removePregnancy(this);
        if(isRecursive) {
            return $super(isRecursive, skipConfirmation);
        }
        else {
            var me = this;
            this.getChildren().each(function(child) {
                me.removeChild(child);
                if(child.getType() == &#x27;PlaceHolder&#x27;) {
                    child.remove(false, true);
                }
            });
            this.getGraphics().remove();
            this.getPartnership().removePregnancy(me);
            return $super(false);
        }
    },

    &#x2F;***
     * Returns lower neighbors of this node in the tree graph
     *
     * @method getLowerNeighbors
     * @return {Array}
     *&#x2F;
    getLowerNeighbors: function() {
        return this.getChildren();
    },

    &#x2F;**
     * Returns side neighbors of this node in the tree graph
     *
     * @method getSideNeighbors
     * @return {Array}
     *&#x2F;
    getSideNeighbors: function() {
        return [];
    },

    &#x2F;**
     * Returns upper neighbors of this node in the tree graph
     *
     * @method getUpperNeighbors
     * @return {Array}
     *&#x2F;
    getUpperNeighbors: function() {
        return this.getPartnership();
    },

    &#x2F;**
     * Returns true if someNode can be a child of this pregnancy
     *
     * @method canBeParentOf
     * @param {AbstractPerson} someNode
     * @return {Boolean}
     *&#x2F;
    canBeParentOf: function(someNode) {
        var compatibleGender = someNode.getGender() == this.getGender() || this.getGender() == &quot;U&quot;;
        return compatibleGender &amp;&amp; this.isChildTypeValid(someNode.getType()) &amp;&amp; this.getPartnership().canBeParentOf(someNode);
    },

    &#x2F;**
     * Returns true if a child of type &#x27;nodeType&#x27; can be added to this pregnancy
     *
     * @method isChildTypeValid
     * @nodeType can be any type of AbstractNode, such as &quot;Person&quot;, &quot;PlaceHolder&quot; and &quot;PersonGroup&quot;
     * @return {Boolean}
     *&#x2F;
    isChildTypeValid: function(nodeType) {
        var validType = editor.getGraph()[&quot;add&quot; + nodeType];
        var validPlaceHolder = nodeType != &quot;PlaceHolder&quot; || this.getChildren(&quot;PlaceHolder&quot;).length == 0;
        var validPersonGroup = nodeType != &quot;PersonGroup&quot; || this.getChildren(&quot;Person&quot;).length == 0;
        var noPersonGroups = this.getChildren(&quot;PersonGroup&quot;).length == 0;
        return validType &amp;&amp; validPlaceHolder &amp;&amp; validPersonGroup &amp;&amp; noPersonGroups;
    },

    &#x2F;**
     * Returns true if the only child of this pregnancy is a PlaceHolder
     *
     * @method isPlaceHolderPregnancy
     * @return {Boolean}
     *&#x2F;
    isPlaceHolderPregnancy: function() {
        var children = this.getChildren();
        return (children.length == 0) || (children.length = 1 &amp;&amp; children[0].getType() == &quot;PlaceHolder&quot;);
    },

    &#x2F;**
     * Creates a new pregnancy for parent partnership and makes someNode a child of that pregnancy
     *
     * @method separateFromPregnancy
     * @param {AbstractPerson} someNode Child of this pregnancy
     *&#x2F;
    separateFromPregnancy: function(someNode) {
        if(this.hasChild(someNode)) {
            this.removeChild(someNode);
            this.getPartnership().addChild(someNode);
        }
    },

    &#x2F;**
     * Returns True if this pregnancy has any children that are not adopted
     *
     * @method hasNonAdoptedChildren
     * @returns {Boolean}
     *&#x2F;
    hasNonAdoptedChildren: function() {
        var children = this.getChildren(&quot;Person&quot;);
        for(var i = 0; i &lt; children.length; i++) {
            if(!children[i].isAdopted())
                return true;
        }
        return false;
    },

    &#x2F;**
     * Toggles the pregnancy bubble interactivity active or inactive
     *
     * @method setActive
     * @param {Boolean} isActive Set to True to make pregnancy interactive
     *&#x2F;
    setActive: function(isActive) {
        if(this._isActive != isActive) {
            this._isActive = isActive;
            this.getGraphics().updateActive();
        }
    },

    &#x2F;**
     * Returns True if the user can currently interactively add new children to this pregnancy
     *
     * @method isActive
     * @return {Boolean}
     *&#x2F;
    isActive: function() {
        return this._isActive;
    },

    &#x2F;**
     * Checks whether the pregnancy junction should be active and updates the active status
     *
     * @method updateActive
     *&#x2F;
    updateActive: function() {
        var adoptedChild = this.getChildren()[0];
        adoptedChild = (adoptedChild &amp;&amp; adoptedChild.isAdopted());
        this.setActive(this.getChildren(&quot;PlaceHolder&quot;, &quot;PersonGroup&quot;).length == 0 &amp;&amp; !adoptedChild);
    },

    &#x2F;**
     * Returns object with serialization data
     *
     * @method getInfo
     * @param [$super]
     * @return {Object}
     *&#x2F;
    getInfo: function($super) {
        var info = $super();
        info[&#x27;partnershipID&#x27;] = this.getPartnership().getID();
        info[&#x27;gender&#x27;] = this.getGender();
        info[&#x27;childrenIDs&#x27;] = [];
        this.getChildren().each(function(child) {
            info[&#x27;childrenIDs&#x27;].push(child.getID());
        });
        return info;
    },

    &#x2F;**
     * Applies properties found in info to this Pregnancy
     *
     * @method loadInfo
     * @param [$super]
     * @param info
     *&#x2F;
    loadInfo: function($super, info) {
        var me = this;
        if($super(info) &amp;&amp; info.gender) {
            if(this.getGender() != info.gender)
                this.setGender(info.gender);
            if(info.childrenIDs){
                info.childrenIDs.each(function(id) {
                    var child = editor.getGraph().getNodeMap()[id];
                    child &amp;&amp; me.addChild(child);
                });
            }
            return true;
        }
        return false;
    }
});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
